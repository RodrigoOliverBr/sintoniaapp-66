
// This file is automatically generated. Do not edit it directly.
import { createClient } from '@supabase/supabase-js';
import type { Database } from './types';

const SUPABASE_URL = "https://pwkzatbaxdvedrwfyyof.supabase.co";
const SUPABASE_PUBLISHABLE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InB3a3phdGJheGR2ZWRyd2Z5eW9mIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDQxNDIzMzEsImV4cCI6MjA1OTcxODMzMX0.5IHPciyaEVstcqcmAHZQUa9zXCzJeo36JERrXeEUpaA";

// Import the supabase client like this:
// import { supabase } from "@/integrations/supabase/client";

export const supabase = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY, {
  auth: {
    persistSession: true,
    autoRefreshToken: true,
    detectSessionInUrl: false,
  }
});

// Helper para lidar com erros de RLS
export const handleSupabaseError = (error: any): string => {
  console.error("Erro Supabase detalhado:", error);
  
  if (error?.code === '42501' || error?.message?.includes('permission denied')) {
    return 'Erro de permissão: você não tem autorização para realizar esta ação. Verifique se você está autenticado.';
  } else if (error?.code === 'auth/email-already-in-use' || error?.message?.includes('already registered')) {
    return 'Este e-mail já está registrado. Por favor, use outro e-mail.';
  } else if (error?.message?.includes('violates row-level security policy')) {
    return 'Erro de permissão: você não tem autorização para realizar esta ação devido às políticas de segurança.';
  } else if (error?.message?.includes('duplicate key')) {
    return 'Um registro com estas informações já existe.';
  } else if (error?.message?.includes('password')) {
    return 'Erro relacionado à senha. Verifique se ela atende aos critérios de segurança.';
  } else {
    return `Erro ao processar solicitação: ${error?.message || 'Desconhecido'}`;
  }
};
